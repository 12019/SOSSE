<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>SOSSE: fs.h File Reference</title>
<link href="sos.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<h1>fs.h File Reference</h1>  </div>
</div>
<div class="contents">

<p>File system declarations.  
<a href="#_details">More...</a></p>
<code>#include &lt;<a class="el" href="types_8h_source.html">types.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="fstream_8h_source.html">fstream.h</a>&gt;</code><br/>

<p><a href="fs_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structs__fpath.html">s_fpath</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">File path specifier.  <a href="structs__fpath.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structs__finfo.html">s_finfo</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">File info struct. This is directly written as a file header in the file system.  <a href="structs__finfo.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fs_8h.html#af16ffe1e067c0ea1b1e911c36becf620">FS_TYPE_DF</a>&nbsp;&nbsp;&nbsp;0x38</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">File type DF.  <a href="#af16ffe1e067c0ea1b1e911c36becf620"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fs_8h.html#ac1246e5b596fad2ca69d5740720dce64">FS_TYPE_EF</a>&nbsp;&nbsp;&nbsp;0x00</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">File type EF.  <a href="#ac1246e5b596fad2ca69d5740720dce64"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fs_8h.html#a1031facaa31a457c28f86cf221f16bc0">FS_HEADER_SIZE</a>&nbsp;&nbsp;&nbsp;sizeof(<a class="el" href="structs__finfo.html">S_FINFO</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Size of the file header, which is the same as S_FINFO.  <a href="#a1031facaa31a457c28f86cf221f16bc0"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structs__fpath.html">s_fpath</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fs_8h.html#a05724eefbb251b0605e377d023303f40">S_FPATH</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">File path specifier.  <a href="#a05724eefbb251b0605e377d023303f40"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structs__finfo.html">s_finfo</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fs_8h.html#a69886b9db44928da9d4b49d46de14687">S_FINFO</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">File info struct. This is directly written as a file header in the file system.  <a href="#a69886b9db44928da9d4b49d46de14687"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="types_8h.html#a97a80ca1602ebf2303258971a2c938e2">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fs_8h.html#afb19e37469a751aa61de3dcd0c70b4b0">fs_init</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize file system variables.  <a href="#afb19e37469a751aa61de3dcd0c70b4b0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="types_8h.html#a97a80ca1602ebf2303258971a2c938e2">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fs_8h.html#a4d8d9be27ddc2dcba0f38f8e27f470d7">fs_seek</a> (<a class="el" href="types_8h.html#af78b002cffb8a135ab10841bc49e3e14">iu16</a> fid, <a class="el" href="structs__fstream.html">S_FSTREAM</a> *fs, <a class="el" href="structs__finfo.html">S_FINFO</a> *fi, <a class="el" href="types_8h.html#a95a7dea5cbac1a117a50dccc69944d6e">iu8</a> type)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Look for a file in a stream.  <a href="#a4d8d9be27ddc2dcba0f38f8e27f470d7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="types_8h.html#a97a80ca1602ebf2303258971a2c938e2">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fs_8h.html#a17c9e75dcbad83e1e24dfc89286fbc2b">fs_seekEnd</a> (<a class="el" href="structs__fstream.html">S_FSTREAM</a> *fs)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Look for the end of files in the stream.  <a href="#a17c9e75dcbad83e1e24dfc89286fbc2b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="types_8h.html#a97a80ca1602ebf2303258971a2c938e2">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fs_8h.html#a53716a136dbb532afc17ffc353b9d69c">fs_getData</a> (<a class="el" href="structs__fpath.html">S_FPATH</a> *fp, <a class="el" href="structs__fstream.html">S_FSTREAM</a> *fs, <a class="el" href="structs__finfo.html">S_FINFO</a> *fi)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get stream and info for a file specified as a path.  <a href="#a53716a136dbb532afc17ffc353b9d69c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="types_8h.html#a97a80ca1602ebf2303258971a2c938e2">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fs_8h.html#a69a59c2c985e21a61a4bbeb844ed900b">fs_getFPath</a> (<a class="el" href="types_8h.html#af78b002cffb8a135ab10841bc49e3e14">iu16</a> fid, <a class="el" href="structs__fpath.html">S_FPATH</a> *fp, <a class="el" href="structs__fstream.html">S_FSTREAM</a> *fs, <a class="el" href="structs__finfo.html">S_FINFO</a> *fi)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get path, stream and info for a file specified as a FID.  <a href="#a69a59c2c985e21a61a4bbeb844ed900b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="types_8h.html#a97a80ca1602ebf2303258971a2c938e2">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fs_8h.html#a5b9133c311ff42d94c92599c2a9d9d96">fs_delete</a> (<a class="el" href="types_8h.html#af78b002cffb8a135ab10841bc49e3e14">iu16</a> fid)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Delete file specified as fid.  <a href="#a5b9133c311ff42d94c92599c2a9d9d96"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="types_8h.html#a97a80ca1602ebf2303258971a2c938e2">bool</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fs_8h.html#af3cd0f092dc20a811aefb18cda7b0260">fs_create</a> (<a class="el" href="structs__finfo.html">S_FINFO</a> *fi)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The function creates a file.  <a href="#af3cd0f092dc20a811aefb18cda7b0260"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structs__fpath.html">S_FPATH</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fs_8h.html#afa513b91ca575d59f5d6c481a521ab17">selected</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Path specified of the currently selected file.  <a href="#afa513b91ca575d59f5d6c481a521ab17"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>File system declarations. </p>
<p>SOSSE implements a very simple file system. Each file starts with following header:</p>
<ul>
<li>2 Byte: Content size</li>
<li>2 Byte: ID</li>
<li>1 Byte: Type</li>
<li>1 Byte: Access conditions</li>
</ul>
<p>Directly after that the content area is located. If the file is a DF, this content area is directly used to add header/content sequences.</p>
<p>After the content area of a file, a content size of 0 must be writen as an end of data marker. This means the data capacity of a MF or DF is the total content size of it minus 2.</p>
<p>Currently the file system support only one level of DFs, i.e. the maximum depth is MF:DF:EF.</p>
<p>There are probably a lot optimization possibilities in this file system, but I think this is not bad for my first designed and implemented file system.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd>Here are certainly some optimizations possible to reduce code size.</dd></dl>
<dl class="rcs"><dt><b>Id:</b></dt><dd><a class="el" href="fs_8h.html" title="File system declarations.">fs.h</a>,v 1.13 2002/12/22 15:42:55 m Exp </dd></dl>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a1031facaa31a457c28f86cf221f16bc0"></a><!-- doxytag: member="fs.h::FS_HEADER_SIZE" ref="a1031facaa31a457c28f86cf221f16bc0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FS_HEADER_SIZE&nbsp;&nbsp;&nbsp;sizeof(<a class="el" href="structs__finfo.html">S_FINFO</a>)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Size of the file header, which is the same as S_FINFO. </p>

<p>Referenced by <a class="el" href="fs_8h.html#a5b9133c311ff42d94c92599c2a9d9d96">fs_delete()</a>.</p>

</div>
</div>
<a class="anchor" id="af16ffe1e067c0ea1b1e911c36becf620"></a><!-- doxytag: member="fs.h::FS_TYPE_DF" ref="af16ffe1e067c0ea1b1e911c36becf620" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FS_TYPE_DF&nbsp;&nbsp;&nbsp;0x38</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>File type DF. </p>

<p>Referenced by <a class="el" href="commands_8h.html#a3c4d6ec9b132006edab635f42f6b1143">cmd_create()</a>, <a class="el" href="commands_8h.html#ab5e91199098e25652dd3dbc7aea27683">cmd_delete()</a>, <a class="el" href="fs_8h.html#af3cd0f092dc20a811aefb18cda7b0260">fs_create()</a>, and <a class="el" href="fs_8h.html#a53716a136dbb532afc17ffc353b9d69c">fs_getData()</a>.</p>

</div>
</div>
<a class="anchor" id="ac1246e5b596fad2ca69d5740720dce64"></a><!-- doxytag: member="fs.h::FS_TYPE_EF" ref="ac1246e5b596fad2ca69d5740720dce64" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FS_TYPE_EF&nbsp;&nbsp;&nbsp;0x00</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>File type EF. </p>

<p>Referenced by <a class="el" href="auth_8h.html#a57b022e6fdb6bbdd9c479d3a6b9fb6c0">auth_getCheckPinLen()</a>, <a class="el" href="commands_8h.html#a892cbb2f7983a3bca95719fa78397eb4">cmd_readBinary()</a>, <a class="el" href="commands_8h.html#aa4f0817c641ea482d8bbd9a62d4a56b5">cmd_updateBinary()</a>, <a class="el" href="fs_8h.html#af3cd0f092dc20a811aefb18cda7b0260">fs_create()</a>, and <a class="el" href="fs_8h.html#a53716a136dbb532afc17ffc353b9d69c">fs_getData()</a>.</p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="a69886b9db44928da9d4b49d46de14687"></a><!-- doxytag: member="fs.h::S_FINFO" ref="a69886b9db44928da9d4b49d46de14687" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structs__finfo.html">s_finfo</a>  <a class="el" href="structs__finfo.html">S_FINFO</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>File info struct. This is directly written as a file header in the file system. </p>

</div>
</div>
<a class="anchor" id="a05724eefbb251b0605e377d023303f40"></a><!-- doxytag: member="fs.h::S_FPATH" ref="a05724eefbb251b0605e377d023303f40" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structs__fpath.html">s_fpath</a>  <a class="el" href="structs__fpath.html">S_FPATH</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>File path specifier. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>There is probably a potential for simplification, when the file type (DF/EF) is not handled so rigid. </dd></dl>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="af3cd0f092dc20a811aefb18cda7b0260"></a><!-- doxytag: member="fs.h::fs_create" ref="af3cd0f092dc20a811aefb18cda7b0260" args="(S_FINFO *fi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#a97a80ca1602ebf2303258971a2c938e2">bool</a> fs_create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__finfo.html">S_FINFO</a> *&nbsp;</td>
          <td class="paramname"> <em>fi</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The function creates a file. </p>
<p>The functions creates a file with the data in <em>fi</em>. The current file must be a MF or DF. In case the current file is a DF, the file, which should be created, can't be a DF.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fi</em>&nbsp;</td><td>Pointer to S_FINFO, which contains the data of the file to create.</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>TRUE</em>&nbsp;</td><td>on success. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FALSE</em>&nbsp;</td><td>on failure. Error code given in sw. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="structs__fpath.html#aa16acae1b4ba3966c13fe44b278ced64">s_fpath::df</a>, <a class="el" href="structs__fpath.html#ae8103a76874a6b0588c88303126477c7">s_fpath::ef</a>, <a class="el" href="types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="el" href="structs__finfo.html#a864b248ae358e708aec64b7d7ddc35f3">s_finfo::fid</a>, <a class="el" href="fs_8c.html#a53716a136dbb532afc17ffc353b9d69c">fs_getData()</a>, <a class="el" href="fs_8c.html#a4d8d9be27ddc2dcba0f38f8e27f470d7">fs_seek()</a>, <a class="el" href="fs_8c.html#a17c9e75dcbad83e1e24dfc89286fbc2b">fs_seekEnd()</a>, <a class="el" href="fs_8h.html#af16ffe1e067c0ea1b1e911c36becf620">FS_TYPE_DF</a>, <a class="el" href="fs_8h.html#ac1246e5b596fad2ca69d5740720dce64">FS_TYPE_EF</a>, <a class="el" href="fs_8c.html#a70ebcad91d36b8f6fc7f2f3ba5d292a6">fssize</a>, <a class="el" href="fs_8c.html#a3120fb23f27b2aed57412777711a2ce6">fsstart</a>, <a class="el" href="fstream_8c.html#ae973258fc48b63c8cc36ccc7168b1908">fstream_write()</a>, <a class="el" href="structs__fstream.html#a40b2594138d6556befc29a2c75d254cf">s_fstream::pos</a>, <a class="el" href="structs__fstream.html#ab803d160e579a1969b9803f19b7a0814">s_fstream::size</a>, <a class="el" href="structs__finfo.html#ae59b244a2c42920a988419568a0d4ab5">s_finfo::size</a>, <a class="el" href="structs__fstream.html#a4427473894e909d279b9fb12fba358e5">s_fstream::start</a>, <a class="el" href="sw_8h.html#ac5377a40197386a6b59fbf99128e0c16a544d38acdb172010e2096c1fe560f33d">SW_FILE_EXISTS</a>, <a class="el" href="sw_8h.html#ac5377a40197386a6b59fbf99128e0c16ae1ed86541f1e21fe2ceb8cdba70e9664">SW_FILE_TO_SHORT</a>, <a class="el" href="sw_8c.html#a06244878ad482424dc04d05cfdc81b7b">sw_set()</a>, <a class="el" href="sw_8h.html#ac5377a40197386a6b59fbf99128e0c16a4d90cdbadb0e74727d9523cd4a7176c6">SW_WRONG_DATA</a>, <a class="el" href="transaction_8c.html#acacd724418635980cbe9ff7caab01e9c">ta_commit()</a>, <a class="el" href="transaction_8c.html#ae0ead4e9d2dc0e305973f13324a356aa">ta_setdata()</a>, and <a class="el" href="structs__finfo.html#a41bbc495939ea65ac01a8e210bf9a47c">s_finfo::type</a>.</p>

<p>Referenced by <a class="el" href="commands_8h.html#a3c4d6ec9b132006edab635f42f6b1143">cmd_create()</a>, and <a class="el" href="fstest_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a5b9133c311ff42d94c92599c2a9d9d96"></a><!-- doxytag: member="fs.h::fs_delete" ref="a5b9133c311ff42d94c92599c2a9d9d96" args="(iu16 fid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#a97a80ca1602ebf2303258971a2c938e2">bool</a> fs_delete </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#af78b002cffb8a135ab10841bc49e3e14">iu16</a>&nbsp;</td>
          <td class="paramname"> <em>fid</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Delete file specified as fid. </p>
<p>The function looks for the fid in the current file, which must be a MF or DF. The file, which should be deleted must be the last one in the current MF or DF.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fid</em>&nbsp;</td><td>ID of the file to delete.</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>TRUE</em>&nbsp;</td><td>on success. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FALSE</em>&nbsp;</td><td>on failure. Error code given in sw. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="structs__fpath.html#aa16acae1b4ba3966c13fe44b278ced64">s_fpath::df</a>, <a class="el" href="structs__fpath.html#ae8103a76874a6b0588c88303126477c7">s_fpath::ef</a>, <a class="el" href="types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="el" href="fs_8c.html#a53716a136dbb532afc17ffc353b9d69c">fs_getData()</a>, <a class="el" href="fs_8h.html#a1031facaa31a457c28f86cf221f16bc0">FS_HEADER_SIZE</a>, <a class="el" href="fstream_8c.html#a386424e62f60cec15c42698f322001e8">fstream_read()</a>, <a class="el" href="fstream_8c.html#ae973258fc48b63c8cc36ccc7168b1908">fstream_write()</a>, <a class="el" href="structs__fstream.html#a40b2594138d6556befc29a2c75d254cf">s_fstream::pos</a>, <a class="el" href="structs__finfo.html#ae59b244a2c42920a988419568a0d4ab5">s_finfo::size</a>, <a class="el" href="structs__fstream.html#ab803d160e579a1969b9803f19b7a0814">s_fstream::size</a>, <a class="el" href="structs__fstream.html#a4427473894e909d279b9fb12fba358e5">s_fstream::start</a>, <a class="el" href="sw_8h.html#ac5377a40197386a6b59fbf99128e0c16a30cb9ce5c29638a39404a551c3e4e283">SW_INCOMPATIBLE_FILE</a>, <a class="el" href="sw_8h.html#ac5377a40197386a6b59fbf99128e0c16a5d90427b96fdd79122d561a2804bd436">SW_NOT_ALLOWED</a>, <a class="el" href="sw_8c.html#a06244878ad482424dc04d05cfdc81b7b">sw_set()</a>, <a class="el" href="transaction_8c.html#acacd724418635980cbe9ff7caab01e9c">ta_commit()</a>, and <a class="el" href="transaction_8c.html#ae0ead4e9d2dc0e305973f13324a356aa">ta_setdata()</a>.</p>

<p>Referenced by <a class="el" href="commands_8h.html#ab5e91199098e25652dd3dbc7aea27683">cmd_delete()</a>, and <a class="el" href="fstest_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a53716a136dbb532afc17ffc353b9d69c"></a><!-- doxytag: member="fs.h::fs_getData" ref="a53716a136dbb532afc17ffc353b9d69c" args="(S_FPATH *fp, S_FSTREAM *fs, S_FINFO *fi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#a97a80ca1602ebf2303258971a2c938e2">bool</a> fs_getData </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__fpath.html">S_FPATH</a> *&nbsp;</td>
          <td class="paramname"> <em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structs__fstream.html">S_FSTREAM</a> *&nbsp;</td>
          <td class="paramname"> <em>fs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structs__finfo.html">S_FINFO</a> *&nbsp;</td>
          <td class="paramname"> <em>fi</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get stream and info for a file specified as a path. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fp</em>&nbsp;</td><td>Pointer to S_FPATH, which is used to supply the information about the file wanted. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fs</em>&nbsp;</td><td>Pointer to S_FSTREAM, which will be filled with data on success. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fi</em>&nbsp;</td><td>Pointer to S_FINFO, which will be filled with data on success.</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>TRUE</em>&nbsp;</td><td>on success. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FALSE</em>&nbsp;</td><td>on failure. Error code given in sw. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="structs__fpath.html#aa16acae1b4ba3966c13fe44b278ced64">s_fpath::df</a>, <a class="el" href="structs__fpath.html#ae8103a76874a6b0588c88303126477c7">s_fpath::ef</a>, <a class="el" href="fs_8c.html#a4d8d9be27ddc2dcba0f38f8e27f470d7">fs_seek()</a>, <a class="el" href="fs_8h.html#af16ffe1e067c0ea1b1e911c36becf620">FS_TYPE_DF</a>, <a class="el" href="fs_8h.html#ac1246e5b596fad2ca69d5740720dce64">FS_TYPE_EF</a>, <a class="el" href="fs_8c.html#a70ebcad91d36b8f6fc7f2f3ba5d292a6">fssize</a>, <a class="el" href="fs_8c.html#a3120fb23f27b2aed57412777711a2ce6">fsstart</a>, <a class="el" href="fstream_8c.html#a386424e62f60cec15c42698f322001e8">fstream_read()</a>, <a class="el" href="structs__fstream.html#a40b2594138d6556befc29a2c75d254cf">s_fstream::pos</a>, <a class="el" href="structs__fstream.html#ab803d160e579a1969b9803f19b7a0814">s_fstream::size</a>, and <a class="el" href="structs__fstream.html#a4427473894e909d279b9fb12fba358e5">s_fstream::start</a>.</p>

<p>Referenced by <a class="el" href="auth_8h.html#a57b022e6fdb6bbdd9c479d3a6b9fb6c0">auth_getCheckPinLen()</a>, <a class="el" href="commands_8h.html#a3c4d6ec9b132006edab635f42f6b1143">cmd_create()</a>, <a class="el" href="commands_8h.html#ab5e91199098e25652dd3dbc7aea27683">cmd_delete()</a>, <a class="el" href="commands_8h.html#a892cbb2f7983a3bca95719fa78397eb4">cmd_readBinary()</a>, <a class="el" href="commands_8h.html#aa4f0817c641ea482d8bbd9a62d4a56b5">cmd_updateBinary()</a>, <a class="el" href="fs_8h.html#af3cd0f092dc20a811aefb18cda7b0260">fs_create()</a>, <a class="el" href="fs_8h.html#a5b9133c311ff42d94c92599c2a9d9d96">fs_delete()</a>, <a class="el" href="fs_8h.html#a69a59c2c985e21a61a4bbeb844ed900b">fs_getFPath()</a>, and <a class="el" href="fstest_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a69a59c2c985e21a61a4bbeb844ed900b"></a><!-- doxytag: member="fs.h::fs_getFPath" ref="a69a59c2c985e21a61a4bbeb844ed900b" args="(iu16 fid, S_FPATH *fp, S_FSTREAM *fs, S_FINFO *fi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#a97a80ca1602ebf2303258971a2c938e2">bool</a> fs_getFPath </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#af78b002cffb8a135ab10841bc49e3e14">iu16</a>&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structs__fpath.html">S_FPATH</a> *&nbsp;</td>
          <td class="paramname"> <em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structs__fstream.html">S_FSTREAM</a> *&nbsp;</td>
          <td class="paramname"> <em>fs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structs__finfo.html">S_FINFO</a> *&nbsp;</td>
          <td class="paramname"> <em>fi</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get path, stream and info for a file specified as a FID. </p>
<p>The file is searched for in the order described in the SELECT FILE documentation on the main page.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fid</em>&nbsp;</td><td>File ID to look for. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fp</em>&nbsp;</td><td>Pointer to S_FPATH, which will be filled with data on success. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fs</em>&nbsp;</td><td>Pointer to S_FSTREAM, which will be filled with data on success. This can be NULL when no data is wanted. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fi</em>&nbsp;</td><td>Pointer to S_FINFO, which will be filled with data on success. This can be NULL when no data is wanted.</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>TRUE</em>&nbsp;</td><td>on success. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FALSE</em>&nbsp;</td><td>on failure. Error code given in sw. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="structs__fpath.html#aa16acae1b4ba3966c13fe44b278ced64">s_fpath::df</a>, <a class="el" href="structs__fpath.html#ae8103a76874a6b0588c88303126477c7">s_fpath::ef</a>, <a class="el" href="fs_8c.html#a53716a136dbb532afc17ffc353b9d69c">fs_getData()</a>, <a class="el" href="sw_8h.html#ac5377a40197386a6b59fbf99128e0c16ad983f0d2b14b39d009aa879049ca3d64">SW_FILE_NOT_FOUND</a>, <a class="el" href="sw_8c.html#a06244878ad482424dc04d05cfdc81b7b">sw_set()</a>, and <a class="el" href="sw_8h.html#ac5377a40197386a6b59fbf99128e0c16a4d90cdbadb0e74727d9523cd4a7176c6">SW_WRONG_DATA</a>.</p>

<p>Referenced by <a class="el" href="commands_8h.html#a338c589b70e1e97960452b9f7b124c46">cmd_select()</a>, and <a class="el" href="fstest_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>

</div>
</div>
<a class="anchor" id="afb19e37469a751aa61de3dcd0c70b4b0"></a><!-- doxytag: member="fs.h::fs_init" ref="afb19e37469a751aa61de3dcd0c70b4b0" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#a97a80ca1602ebf2303258971a2c938e2">bool</a> fs_init </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize file system variables. </p>
<p>This looks e.g. for the start of the file system and it's size. It must be called after each reset.</p>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>TRUE</em>&nbsp;</td><td>on success. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FALSE</em>&nbsp;</td><td>on failure. Error code given in sw. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="config_8h.html#a2fe18215cfc6471fce1d55880a302c1e">FS_START_PTR_ADDR</a>, <a class="el" href="fs_8c.html#a70ebcad91d36b8f6fc7f2f3ba5d292a6">fssize</a>, <a class="el" href="fs_8c.html#a3120fb23f27b2aed57412777711a2ce6">fsstart</a>, and <a class="el" href="hal-emu_8c.html#ae23736f92fbd6e59f6e67a191e69ecef">hal_eeprom_read()</a>.</p>

<p>Referenced by <a class="el" href="authtest_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a4d8d9be27ddc2dcba0f38f8e27f470d7"></a><!-- doxytag: member="fs.h::fs_seek" ref="a4d8d9be27ddc2dcba0f38f8e27f470d7" args="(iu16 fid, S_FSTREAM *fs, S_FINFO *fi, iu8 type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#a97a80ca1602ebf2303258971a2c938e2">bool</a> fs_seek </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#af78b002cffb8a135ab10841bc49e3e14">iu16</a>&nbsp;</td>
          <td class="paramname"> <em>fid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structs__fstream.html">S_FSTREAM</a> *&nbsp;</td>
          <td class="paramname"> <em>fs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structs__finfo.html">S_FINFO</a> *&nbsp;</td>
          <td class="paramname"> <em>fi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a95a7dea5cbac1a117a50dccc69944d6e">iu8</a>&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Look for a file in a stream. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fid</em>&nbsp;</td><td>File ID to look for. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fs</em>&nbsp;</td><td>Pointer to S_FSTREAM, where the FID is searched for. It returns on success a stream on the file found. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fi</em>&nbsp;</td><td>Pointer to S_FINFO, which will be filled with data on success. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>type</em>&nbsp;</td><td>Type of file wanted.</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>TRUE</em>&nbsp;</td><td>on success. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FALSE</em>&nbsp;</td><td>on failure. Error code given in sw.</td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000006">Todo:</a></b></dt><dd>There is probably a potential for simplification, when the file type is not handled so rigid. </dd></dl>

<p>References <a class="el" href="fs_8c.html#a70ebcad91d36b8f6fc7f2f3ba5d292a6">fssize</a>, <a class="el" href="fs_8c.html#a3120fb23f27b2aed57412777711a2ce6">fsstart</a>, <a class="el" href="fstream_8c.html#a386424e62f60cec15c42698f322001e8">fstream_read()</a>, <a class="el" href="structs__fstream.html#a40b2594138d6556befc29a2c75d254cf">s_fstream::pos</a>, <a class="el" href="structs__fstream.html#ab803d160e579a1969b9803f19b7a0814">s_fstream::size</a>, <a class="el" href="structs__fstream.html#a4427473894e909d279b9fb12fba358e5">s_fstream::start</a>, <a class="el" href="sw_8h.html#ac5377a40197386a6b59fbf99128e0c16ad983f0d2b14b39d009aa879049ca3d64">SW_FILE_NOT_FOUND</a>, and <a class="el" href="sw_8c.html#a06244878ad482424dc04d05cfdc81b7b">sw_set()</a>.</p>

<p>Referenced by <a class="el" href="fs_8h.html#af3cd0f092dc20a811aefb18cda7b0260">fs_create()</a>, and <a class="el" href="fs_8h.html#a53716a136dbb532afc17ffc353b9d69c">fs_getData()</a>.</p>

</div>
</div>
<a class="anchor" id="a17c9e75dcbad83e1e24dfc89286fbc2b"></a><!-- doxytag: member="fs.h::fs_seekEnd" ref="a17c9e75dcbad83e1e24dfc89286fbc2b" args="(S_FSTREAM *fs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#a97a80ca1602ebf2303258971a2c938e2">bool</a> fs_seekEnd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structs__fstream.html">S_FSTREAM</a> *&nbsp;</td>
          <td class="paramname"> <em>fs</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Look for the end of files in the stream. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fs</em>&nbsp;</td><td>Pointer to S_FSTREAM, which supplies a directory stream and which will be used to return the end position on success.</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>TRUE</em>&nbsp;</td><td>on success. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FALSE</em>&nbsp;</td><td>on failure. Error code given in sw. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="fstream_8c.html#a386424e62f60cec15c42698f322001e8">fstream_read()</a>, and <a class="el" href="structs__fstream.html#a40b2594138d6556befc29a2c75d254cf">s_fstream::pos</a>.</p>

<p>Referenced by <a class="el" href="fs_8h.html#af3cd0f092dc20a811aefb18cda7b0260">fs_create()</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="afa513b91ca575d59f5d6c481a521ab17"></a><!-- doxytag: member="fs.h::selected" ref="afa513b91ca575d59f5d6c481a521ab17" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structs__fpath.html">S_FPATH</a> <a class="el" href="fs_8h.html#afa513b91ca575d59f5d6c481a521ab17">selected</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Path specified of the currently selected file. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000005">Todo:</a></b></dt><dd>Saving here a S_FINFO and/or S_FSTREAM of the selected file might reduce the code size. </dd></dl>

<p>Referenced by <a class="el" href="commands_8h.html#a3c4d6ec9b132006edab635f42f6b1143">cmd_create()</a>, <a class="el" href="commands_8h.html#ab5e91199098e25652dd3dbc7aea27683">cmd_delete()</a>, <a class="el" href="commands_8h.html#a892cbb2f7983a3bca95719fa78397eb4">cmd_readBinary()</a>, <a class="el" href="commands_8h.html#a338c589b70e1e97960452b9f7b124c46">cmd_select()</a>, <a class="el" href="commands_8h.html#aa4f0817c641ea482d8bbd9a62d4a56b5">cmd_updateBinary()</a>, and <a class="el" href="fstest_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>

</div>
</div>
</div>
<hr><address><small>
Copyright 2002 by Matthias Bruestle. This is licensed under the GNU
General Public License.
</small></address>
</body>
</html>
